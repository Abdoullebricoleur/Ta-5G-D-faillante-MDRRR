<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Network Monitor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Chart.js pour le graphique -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg-main: radial-gradient(circle at top, #151531 0, #050509 55%, #000000 100%);
      --glass-bg: rgba(10, 10, 25, 0.78);
      --glass-border: rgba(167, 79, 255, 0.55);
      --accent1: #5d2eff;
      --accent2: #a74fff;
      --accent3: #46b5ff;
      --text-main: #f8f4ff;
      --text-muted: #9ca0c5;
      --danger: #ff4f7b;
      --success: #6bff9b;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      width: 100%;
      max-width: 480px;
      min-height: 100vh;
      padding: 16px 16px 76px;
      position: relative;
      overflow: hidden;
    }

    /* Aura en fond (effet n√©on flou) */
    .aura {
      position: fixed;
      inset: -40%;
      pointer-events: none;
      z-index: -1;
      background:
        radial-gradient(circle at 0% 0%, rgba(93, 46, 255, 0.25), transparent 60%),
        radial-gradient(circle at 100% 0%, rgba(167, 79, 255, 0.35), transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(70, 181, 255, 0.2), transparent 60%);
      filter: blur(4px);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 4px 12px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .title-block span {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .title-block h1 {
      font-size: 26px;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-shadow: 0 0 12px rgba(167, 79, 255, 0.7);
    }

    .icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: radial-gradient(circle at 30% 0%, rgba(255, 255, 255, 0.08), rgba(5, 5, 9, 0.95));
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      cursor: pointer;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
      box-shadow: 0 0 0 rgba(167, 79, 255, 0);
    }

    .icon-btn:hover {
      transform: translateY(-1px);
      border-color: rgba(167, 79, 255, 0.65);
      box-shadow: 0 0 18px rgba(167, 79, 255, 0.35);
    }

    main {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 6px;
    }

    .screen {
      display: none;
      animation: fadeIn 0.25s ease-out;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(6px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .glass-card {
      background: radial-gradient(circle at top left, rgba(167, 79, 255, 0.1), rgba(5, 5, 12, 0.98));
      border-radius: 22px;
      padding: 16px 16px 14px;
      border: 1px solid var(--glass-border);
      box-shadow:
        0 16px 40px rgba(0, 0, 0, 0.65),
        0 0 28px rgba(108, 77, 255, 0.38);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    .glass-card.small-shadow {
      box-shadow:
        0 14px 24px rgba(0, 0, 0, 0.55),
        0 0 18px rgba(108, 77, 255, 0.22);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .card-title {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
    }

    .badge {
      font-size: 11px;
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(255, 255, 255, 0.02);
      color: var(--accent3);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 0, #46b5ff, #7a4cff);
      box-shadow: 0 0 10px rgba(108, 77, 255, 0.9);
    }

    /* Indicateur circulaire */
    .circle-wrapper {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .circle {
      width: 120px;
      height: 120px;
      border-radius: 999px;
      background:
        radial-gradient(circle at 25% 0, rgba(255, 255, 255, 0.18), transparent 55%),
        conic-gradient(from 220deg, #5d2eff, #a74fff, #46b5ff, #5d2eff);
      padding: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow:
        0 0 32px rgba(93, 46, 255, 0.9),
        0 0 46px rgba(70, 181, 255, 0.6);
    }

    .circle-inner {
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background: radial-gradient(circle at 30% 0, rgba(255, 255, 255, 0.06), rgba(2, 2, 8, 0.98));
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      text-align: center;
    }

    .circle-percentage {
      font-size: 26px;
      font-weight: 600;
    }

    .circle-label {
      font-size: 12px;
      color: var(--text-muted);
    }

    .quality-pill {
      margin-top: 2px;
      font-size: 11px;
      padding: 2px 10px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(107, 255, 155, 0.12), rgba(18, 82, 48, 0.9));
      border: 1px solid rgba(107, 255, 155, 0.5);
      color: var(--success);
    }

    .circle-text-block {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .value-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 13px;
      padding: 6px 0;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.06);
    }

    .value-row:last-child {
      border-bottom: none;
    }

    .label {
      color: var(--text-muted);
      font-size: 12px;
    }

    .value {
      font-weight: 500;
      display: inline-flex;
      align-items: baseline;
      gap: 4px;
    }

    .value-unit {
      font-size: 11px;
      color: var(--text-muted);
    }

    .trend {
      font-size: 11px;
      padding: 1px 7px;
      border-radius: 999px;
      background: rgba(107, 255, 155, 0.08);
      border: 1px solid rgba(107, 255, 155, 0.5);
      color: var(--success);
    }

    .trend.negative {
      background: rgba(255, 79, 123, 0.08);
      border-color: rgba(255, 79, 123, 0.5);
      color: var(--danger);
    }

    /* Bouton scan */
    .primary-btn {
      margin-top: 14px;
      width: 100%;
      padding: 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-main);
      background-image: linear-gradient(135deg, var(--accent1), var(--accent2));
      box-shadow:
        0 12px 28px rgba(94, 53, 255, 0.65),
        0 0 20px rgba(167, 79, 255, 0.8);
      position: relative;
      overflow: hidden;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

    .primary-btn::before {
      content: "";
      position: absolute;
      top: -60%;
      left: -80%;
      width: 60%;
      height: 220%;
      background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.55), transparent);
      opacity: 0;
      transform: translateX(-100%);
    }

    .primary-btn:hover::before {
      opacity: 0.75;
      transform: translateX(220%);
      transition: transform 0.7s ease, opacity 0.35s ease;
    }

    .primary-btn:active {
      transform: translateY(1px) scale(0.99);
      box-shadow:
        0 5px 16px rgba(94, 53, 255, 0.5),
        0 0 14px rgba(167, 79, 255, 0.7);
    }

    .primary-btn span {
      position: relative;
      z-index: 1;
    }

    /* Graphique */
    .chart-wrapper {
      margin-top: 10px;
      background: radial-gradient(circle at top, rgba(55, 55, 95, 0.6), rgba(5, 5, 12, 0.98));
      border-radius: 20px;
      padding: 10px;
      border: 1px solid rgba(118, 118, 180, 0.65);
      box-shadow:
        0 18px 36px rgba(0, 0, 0, 0.7),
        0 0 18px rgba(79, 123, 255, 0.45);
    }

    /* Historique */
    .history-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .history-item {
      padding: 10px 12px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(13, 13, 30, 0.96), rgba(4, 4, 9, 0.98));
      border: 1px solid rgba(132, 91, 255, 0.55);
      box-shadow:
        0 12px 26px rgba(0, 0, 0, 0.7),
        0 0 18px rgba(93, 46, 255, 0.35);
    }

    .history-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .history-date {
      font-weight: 500;
      color: var(--text-main);
      font-size: 13px;
    }

    .history-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      margin-top: 4px;
    }

    .delta {
      font-size: 11px;
      padding: 1px 6px;
      border-radius: 999px;
      border: 1px solid rgba(107, 255, 155, 0.5);
      color: var(--success);
      background: rgba(107, 255, 155, 0.08);
    }

    .delta.bad {
      border-color: rgba(255, 79, 123, 0.65);
      color: var(--danger);
      background: rgba(255, 79, 123, 0.08);
    }

    /* Param√®tres */
    .settings-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .setting-card {
      padding: 10px 12px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(14, 14, 30, 0.96), rgba(3, 3, 8, 0.98));
      border: 1px solid rgba(132, 91, 255, 0.4);
      box-shadow:
        0 10px 22px rgba(0, 0, 0, 0.7),
        0 0 14px rgba(132, 91, 255, 0.3);
    }

    .setting-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3px;
      font-size: 13px;
    }

    .setting-title {
      font-weight: 500;
    }

    .setting-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    .setting-control {
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .pill-options {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      font-size: 11px;
      color: var(--text-muted);
      background: rgba(255, 255, 255, 0.02);
      transition: all 0.15s ease;
    }

    .pill.active {
      border-color: rgba(167, 79, 255, 0.9);
      background: linear-gradient(135deg, rgba(93, 46, 255, 0.55), rgba(167, 79, 255, 0.9));
      color: white;
      box-shadow:
        0 0 18px rgba(93, 46, 255, 0.85),
        0 0 26px rgba(70, 181, 255, 0.4);
    }

    input[type="range"] {
      width: 100%;
      -webkit-appearance: none;
      appearance: none;
      height: 4px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 0, #ffffff, #a74fff);
      box-shadow:
        0 0 12px rgba(167, 79, 255, 0.9),
        0 0 18px rgba(70, 181, 255, 0.6);
      cursor: pointer;
    }

    /* Barre d'onglets */
    .tabbar {
      position: fixed;
      left: 50%;
      bottom: 14px;
      width: 100%;
      max-width: 460px;
      transform: translateX(-50%);
      padding: 6px 18px 10px;
      z-index: 20;
    }

    .tabbar-inner {
      border-radius: 999px;
      padding: 6px;
      background: rgba(5, 5, 12, 0.92);
      border: 1px solid rgba(122, 76, 255, 0.9);
      box-shadow:
        0 18px 36px rgba(0, 0, 0, 0.85),
        0 0 32px rgba(122, 76, 255, 0.7);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }

    .tab-btn {
      flex: 1;
      border-radius: 999px;
      padding: 6px 10px;
      border: none;
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      color: var(--text-muted);
      font-size: 12px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: color 0.15s ease, background 0.15s ease;
    }

    .tab-btn span.icon {
      font-size: 16px;
    }

    .tab-btn span.label {
      font-size: 12px;
    }

    .tab-btn.active {
      color: white;
      background: radial-gradient(circle at top, rgba(93, 46, 255, 0.95), rgba(9, 9, 18, 0.98));
      box-shadow:
        0 0 24px rgba(93, 46, 255, 0.9),
        0 0 30px rgba(70, 181, 255, 0.65);
    }

    .tab-btn.active::before {
      content: "";
      position: absolute;
      inset: -60%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.25), transparent 70%);
      opacity: 0.25;
    }

    @media (max-width: 400px) {
      .circle {
        width: 108px;
        height: 108px;
      }

      .app {
        padding-inline: 10px;
      }
    }
  </style>
</head>

<body>
<div class="aura"></div>

<div class="app">
  <header>
    <div class="title-block">
      <span>Monitor</span>
      <h1>Network Monitor</h1>
    </div>
    <button class="icon-btn" type="button" title="Param√®tres rapides">
      ‚öôÔ∏è
    </button>
  </header>

  <main>
    <!-- DASHBOARD -->
    <section class="screen active" data-screen="dashboard">
      <div class="glass-card">
        <div class="card-header">
          <div class="card-title">Qualit√© de la connexion</div>
          <div class="badge">
            <span class="badge-dot"></span>
            <span id="status-label">En temps r√©el</span>
          </div>
        </div>

        <div class="circle-wrapper">
          <div class="circle">
            <div class="circle-inner">
              <div id="quality-percent" class="circle-percentage">82%</div>
              <div class="circle-label">Score global</div>
              <div id="quality-text" class="quality-pill">Stable</div>
            </div>
          </div>

          <div class="circle-text-block">
            <div class="value-row">
              <div>
                <div class="label">Download</div>
                <div class="value">
                  <span id="download-value">42.6</span>
                  <span class="value-unit">Mbps</span>
                </div>
              </div>
              <span id="download-trend" class="trend">+ 2.1</span>
            </div>

            <div class="value-row">
              <div>
                <div class="label">Upload</div>
                <div class="value">
                  <span id="upload-value">11.2</span>
                  <span class="value-unit">Mbps</span>
                </div>
              </div>
              <span id="upload-trend" class="trend">+ 0.3</span>
            </div>

            <div class="value-row">
              <div>
                <div class="label">Ping</div>
                <div class="value">
                  <span id="ping-value">29</span>
                  <span class="value-unit">ms</span>
                </div>
              </div>
              <span id="ping-trend" class="trend">+ 3</span>
            </div>
          </div>
        </div>

        <button id="scan-btn" class="primary-btn" type="button">
          <span>üîÑ Lancer un scan</span>
        </button>

        <div class="chart-wrapper">
          <canvas id="networkChart" height="140"></canvas>
        </div>
      </div>
    </section>

    <!-- HISTORIQUE -->
    <section class="screen" data-screen="history">
      <div class="glass-card small-shadow">
        <div class="card-header">
          <div class="card-title">Historique des tests</div>
          <div class="badge">
            <span class="badge-dot"></span>
            Auto-log
          </div>
        </div>
        <div id="history-list" class="history-list">
          <!-- Items ajout√©s en JS -->
        </div>
      </div>
    </section>

    <!-- PARAM√àTRES -->
    <section class="screen" data-screen="settings">
      <div class="glass-card small-shadow">
        <div class="card-header">
          <div class="card-title">Param√®tres</div>
          <div class="badge">
            ‚ö° Temps r√©el
          </div>
        </div>

        <div class="settings-group">
          <div class="setting-card">
            <div class="setting-header">
              <div class="setting-title">Fr√©quence de scan</div>
              <div id="freq-label" class="setting-subtitle">Toutes les 3 s</div>
            </div>
            <div class="setting-control">
              <input id="freq-range" type="range" min="2" max="15" value="3" />
            </div>
          </div>

          <div class="setting-card">
            <div class="setting-header">
              <div class="setting-title">Sensibilit√©</div>
              <div class="setting-subtitle">Impact sur le score global</div>
            </div>
            <div class="setting-control">
              <div class="pill-options" id="sensitivity-group">
                <button class="pill active" data-level="low">Douce</button>
                <button class="pill" data-level="medium">√âquilibr√©e</button>
                <button class="pill" data-level="high">Nerveuse</button>
              </div>
            </div>
          </div>

          <div class="setting-card">
            <div class="setting-header">
              <div class="setting-title">Th√®me</div>
              <div class="setting-subtitle">Neon / Dark / Soft</div>
            </div>
            <div class="setting-control">
              <div class="pill-options" id="theme-group">
                <button class="pill active" data-theme="neon">Neon</button>
                <button class="pill" data-theme="dark">Dark</button>
                <button class="pill" data-theme="soft">Soft</button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>
  </main>

  <!-- TABBAR -->
  <nav class="tabbar">
    <div class="tabbar-inner">
      <button class="tab-btn active" data-target="dashboard">
        <span class="icon">üè†</span>
        <span class="label">Dashboard</span>
      </button>
      <button class="tab-btn" data-target="history">
        <span class="icon">üìä</span>
        <span class="label">Historique</span>
      </button>
      <button class="tab-btn" data-target="settings">
        <span class="icon">‚öôÔ∏è</span>
        <span class="label">R√©glages</span>
      </button>
    </div>
  </nav>
</div>

<script>
  // ----- Navigation entre onglets -----
  const screens = document.querySelectorAll(".screen");
  const tabButtons = document.querySelectorAll(".tab-btn");

  tabButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      const target = btn.dataset.target;

      // Onglets
      tabButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      // √âcrans
      screens.forEach(s => {
        if (s.dataset.screen === target) s.classList.add("active");
        else s.classList.remove("active");
      });
    });
  });

  // ----- Chart.js : graphique en temps r√©el (faux data pour l'instant) -----
  const ctx = document.getElementById("networkChart").getContext("2d");
  const maxPoints = 20;

  const chartData = {
    labels: [],
    datasets: [
      {
        label: "Download (Mbps)",
        data: [],
        borderWidth: 2,
        tension: 0.35,
        borderColor: "rgba(93, 46, 255, 0.95)",
        pointRadius: 0,
        fill: true,
        backgroundColor: "rgba(93, 46, 255, 0.22)"
      },
      {
        label: "Upload (Mbps)",
        data: [],
        borderWidth: 1.6,
        tension: 0.35,
        borderColor: "rgba(70, 181, 255, 0.9)",
        pointRadius: 0,
        fill: false
      },
      {
        label: "Ping (ms)",
        data: [],
        borderWidth: 1.6,
        tension: 0.35,
        borderColor: "rgba(255, 111, 193, 0.9)",
        pointRadius: 0,
        yAxisID: "y1",
        fill: false
      }
    ]
  };

  const networkChart = new Chart(ctx, {
    type: "line",
    data: chartData,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          ticks: {
            color: "rgba(220, 225, 255, 0.7)",
            font: { size: 9 }
          },
          grid: {
            color: "rgba(120, 120, 180, 0.18)"
          }
        },
        y: {
          beginAtZero: true,
          ticks: {
            color: "rgba(220, 225, 255, 0.7)",
            font: { size: 9 }
          },
          grid: {
            color: "rgba(120, 120, 180, 0.14)"
          }
        },
        y1: {
          position: "right",
          beginAtZero: true,
          ticks: {
            color: "rgba(255, 174, 210, 0.85)",
            font: { size: 9 }
          },
          grid: {
            display: false
          }
        }
      },
      plugins: {
        legend: {
          labels: {
            color: "rgba(230, 232, 255, 0.88)",
            font: { size: 9 }
          }
        }
      },
      animation: {
        duration: 280,
        easing: "easeOutQuad"
      }
    }
  });

  // ----- Faux "scan" r√©seau pour la maquette -----
  let lastDownload = 42.6;
  let lastUpload = 11.2;
  let lastPing = 29;
  let qualityScore = 82;
  let scanInterval = 3000; // ms (li√© au slider)

  const downloadSpan = document.getElementById("download-value");
  const uploadSpan = document.getElementById("upload-value");
  const pingSpan = document.getElementById("ping-value");
  const qualityPercent = document.getElementById("quality-percent");
  const qualityText = document.getElementById("quality-text");
  const downloadTrend = document.getElementById("download-trend");
  const uploadTrend = document.getElementById("upload-trend");
  const pingTrend = document.getElementById("ping-trend");
  const historyList = document.getElementById("history-list");
  const statusLabel = document.getElementById("status-label");

  function randomDelta(range) {
    return (Math.random() * range * 2 - range);
  }

  function clamp(val, min, max) {
    return Math.min(max, Math.max(min, val));
  }

  function updateQualityText(score) {
    if (score > 85) {
      qualityText.textContent = "Excellent";
      qualityText.style.background = "linear-gradient(90deg, rgba(107,255,155,0.28), rgba(18,82,48,1))";
    } else if (score > 65) {
      qualityText.textContent = "Stable";
      qualityText.style.background = "linear-gradient(90deg, rgba(107,255,155,0.2), rgba(18,82,48,0.85))";
    } else if (score > 40) {
      qualityText.textContent = "Irr√©guli√®re";
      qualityText.style.background = "linear-gradient(90deg, rgba(255,230,150,0.3), rgba(130,93,0,0.9))";
    } else {
      qualityText.textContent = "Mauvaise";
      qualityText.style.background = "linear-gradient(90deg, rgba(255,79,123,0.3), rgba(139,28,51,0.95))";
    }
  }

  function addHistoryEntry(download, upload, ping, prevDownload, prevUpload, prevPing) {
    const now = new Date();
    const dateStr = now.toLocaleDateString("fr-FR", { day: "2-digit", month: "2-digit", year: "numeric" });
    const timeStr = now.toLocaleTimeString("fr-FR", { hour: "2-digit", minute: "2-digit" });

    const dlDelta = (download - prevDownload).toFixed(1);
    const ulDelta = (upload - prevUpload).toFixed(1);
    const pingDelta = (ping - prevPing).toFixed(0);

    const item = document.createElement("div");
    item.className = "history-item";
    item.innerHTML = `
      <div class="history-top">
        <div class="history-date">${timeStr} ‚Äî ${dateStr}</div>
        <div class="setting-subtitle">Scan automatique</div>
      </div>
      <div class="history-row">
        <span>Download</span>
        <span>${download.toFixed(1)} Mbps</span>
        <span class="delta ${dlDelta < 0 ? "bad" : ""}">${dlDelta > 0 ? "+" : ""}${dlDelta}</span>
      </div>
      <div class="history-row">
        <span>Upload</span>
        <span>${upload.toFixed(1)} Mbps</span>
        <span class="delta ${ulDelta < 0 ? "bad" : ""}">${ulDelta > 0 ? "+" : ""}${ulDelta}</span>
      </div>
      <div class="history-row">
        <span>Ping</span>
        <span>${ping.toFixed(0)} ms</span>
        <span class="delta ${pingDelta > 0 ? "bad" : ""}">${pingDelta > 0 ? "+" : ""}${pingDelta}</span>
      </div>
    `;

    historyList.prepend(item);
    // On garde par exemple les 20 derniers
    if (historyList.children.length > 20) {
      historyList.removeChild(historyList.lastChild);
    }
  }

  function pushChartPoint(download, upload, ping) {
    const now = new Date();
    const label = now.toLocaleTimeString("fr-FR", { minute: "2-digit", second: "2-digit" });

    chartData.labels.push(label);
    chartData.datasets[0].data.push(download);
    chartData.datasets[1].data.push(upload);
    chartData.datasets[2].data.push(ping);

    if (chartData.labels.length > maxPoints) {
      chartData.labels.shift();
      chartData.datasets.forEach(ds => ds.data.shift());
    }

    networkChart.update();
  }

  function performFakeScan() {
    const prevDownload = lastDownload;
    const prevUpload = lastUpload;
    const prevPing = lastPing;

    // Variation al√©atoire (pour la maquette)
    lastDownload = clamp(lastDownload + randomDelta(4), 5, 300);
    lastUpload = clamp(lastUpload + randomDelta(2), 1, 80);
    lastPing = clamp(lastPing + randomDelta(6), 5, 200);

    // Score qualit√© simplifi√©
    const normalizedDownload = Math.min(lastDownload / 150, 1);
    const normalizedUpload = Math.min(lastUpload / 30, 1);
    const normalizedPing = 1 - Math.min(lastPing / 120, 1);

    qualityScore = clamp(
      (normalizedDownload * 0.45 + normalizedUpload * 0.25 + normalizedPing * 0.3) * 100,
      0,
      100
    );

    // MAJ UI
    downloadSpan.textContent = lastDownload.toFixed(1);
    uploadSpan.textContent = lastUpload.toFixed(1);
    pingSpan.textContent = lastPing.toFixed(0);
    qualityPercent.textContent = qualityScore.toFixed(0) + "%";
    updateQualityText(qualityScore);

    const dlDelta = lastDownload - prevDownload;
    const ulDelta = lastUpload - prevUpload;
    const pingDelta = lastPing - prevPing;

    downloadTrend.textContent = `${dlDelta > 0 ? "+" : ""}${dlDelta.toFixed(1)}`;
    uploadTrend.textContent = `${ulDelta > 0 ? "+" : ""}${ulDelta.toFixed(1)}`;
    pingTrend.textContent = `${pingDelta > 0 ? "+" : ""}${pingDelta.toFixed(0)}`;

    downloadTrend.classList.toggle("negative", dlDelta < 0);
    uploadTrend.classList.toggle("negative", ulDelta < 0);
    pingTrend.classList.toggle("negative", pingDelta > 0);

    // Historique + chart
    addHistoryEntry(lastDownload, lastUpload, lastPing, prevDownload, prevUpload, prevPing);
    pushChartPoint(lastDownload, lastUpload, lastPing);
  }

  // Intervalle auto
  let autoScanTimer = setInterval(performFakeScan, scanInterval);

  // Bouton scan manuel
  const scanBtn = document.getElementById("scan-btn");
  scanBtn.addEventListener("click", () => {
    statusLabel.textContent = "Scan manuel‚Ä¶";
    performFakeScan();
    setTimeout(() => {
      statusLabel.textContent = "En temps r√©el";
    }, 900);
  });

  // ----- Param√®tres : fr√©quence de scan -----
  const freqRange = document.getElementById("freq-range");
  const freqLabel = document.getElementById("freq-label");

  freqRange.addEventListener("input", () => {
    const val = Number(freqRange.value);
    scanInterval = val * 1000;
    freqLabel.textContent = `Toutes les ${val} s`;
    clearInterval(autoScanTimer);
    autoScanTimer = setInterval(performFakeScan, scanInterval);
  });

  // ----- Param√®tres : sensibilit√© (juste stock√©e pour l'instant) -----
  let sensitivity = "low";
  const sensitivityGroup = document.getElementById("sensitivity-group");
  sensitivityGroup.addEventListener("click", (e) => {
    if (e.target.classList.contains("pill")) {
      document.querySelectorAll("#sensitivity-group .pill").forEach(p => p.classList.remove("active"));
      e.target.classList.add("active");
      sensitivity = e.target.dataset.level;
      // TODO : tu peux utiliser `sensitivity` dans ton futur vrai algorithme de score.
    }
  });

  // ----- Param√®tres : th√®me (simple d√©mo, tu pourras adapter) -----
  const themeGroup = document.getElementById("theme-group");
  themeGroup.addEventListener("click", (e) => {
    if (e.target.classList.contains("pill")) {
      document.querySelectorAll("#theme-group .pill").forEach(p => p.classList.remove("active"));
      e.target.classList.add("active");
      const theme = e.target.dataset.theme;
      // Exemple ultra simple pour la maquette :
      if (theme === "neon") {
        document.documentElement.style.setProperty("--bg-main", "radial-gradient(circle at top, #151531 0, #050509 55%, #000000 100%)");
      } else if (theme === "dark") {
        document.documentElement.style.setProperty("--bg-main", "radial-gradient(circle at top, #050509 0, #020208 55%, #000000 100%)");
      } else {
        document.documentElement.style.setProperty("--bg-main", "radial-gradient(circle at top, #24243e 0, #141418 50%, #050509 100%)");
      }
    }
  });

  // On lance quelques points de base au chargement
  for (let i = 0; i < 8; i++) {
    performFakeScan();
  }
</script>
</body>
</html>
